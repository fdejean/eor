---
import { WeeklyFeatureCharts } from '@/components/charts/WeeklyFeatureCharts';
import { FeatureDeepDiveCharts } from '@/components/charts/FeatureDeepDiveCharts';
import { BrandSubredditList } from '@/components/charts/BrandSubredditList';
import { HypothesisCharts } from '@/components/charts/HypothesisCharts';
import { BrandSelector } from '@/components/ui/BrandSelector';
import { FloatingBrandSelector } from '@/components/ui/FloatingBrandSelector';
import { Button } from '@/components/ui/button';
import { ArrowDown, ArrowRight } from 'lucide-react';
---

<!-- Slide 1: Stock Intro (Unchanged) -->
<section id="stock-intro" data-chapter="stock-intro" data-nav-label="Chapter 3: Market" class="h-screen w-full flex items-center justify-center p-8 snap-start bg-muted/30 relative">
    <div class="container max-w-4xl text-center space-y-8">
        <h2 class="text-4xl font-bold tracking-tight lg:text-6xl">Chapter 3: The Market Pulse</h2>
        <p class="text-xl md:text-2xl text-muted-foreground leading-relaxed">
            "Buy the rumor, sell the news." <br/>
            But what if the rumor is trending on r/Apple?
        </p>
         <p class="text-xl text-muted-foreground max-w-2xl mx-auto">
            Now that we have a basic understanding of our emotions, let's look at stock data and compare it to the sentiment analysis.
        </p>
            <div class="pt-8 flex flex-col items-center gap-4">
                <div class="not-prose">
                    <BrandSelector client:visible variant="pills" />
                </div>
                <a href="#stock-sources">
                    <Button variant="outline" size="lg" class="gap-2">
                        Check Data Sources <ArrowDown class="h-4 w-4" />
                    </Button>
                </a>
            </div>
        </div>
    </section>

    </section>

    <!-- Slide 2: Data Sources (New) -->
    <section id="stock-sources" class="h-screen w-full flex items-center justify-center p-8 snap-start bg-background relative overflow-hidden">
        <div class="container max-w-7xl h-[80vh] flex flex-col gap-8">
             <div class="flex justify-between items-center shrink-0">
                <h3 class="text-3xl font-bold lg:text-4xl">Community Sources</h3>
                 <a href="#stock-weekly">
                    <Button variant="outline" class="gap-2">
                        Next: Market Trends <ArrowDown class="h-4 w-4" />
                    </Button>
                </a>
            </div>
            
            <div class="flex-1 w-full min-h-0">
                <BrandSubredditList client:visible />
            </div>
        </div>
    </section>

    <!-- Slide 3: Weekly Trends Horizontal Slider -->
    <section id="stock-weekly" class="h-screen w-full flex items-center justify-center p-8 snap-start bg-background relative overflow-hidden">
        <div class="container max-w-7xl grid grid-cols-1 lg:grid-cols-[3fr_7fr] gap-12 items-center h-full">
            <!-- Sticky Text Side -->
            <div class="space-y-8 order-2 lg:order-1 h-full flex flex-col justify-center">
                <div class="flex justify-between items-center">
                    <h3 class="text-3xl font-bold lg:text-4xl">Weekly Market Trends</h3>
                     <div class="not-prose lg:hidden hidden">
                          <!-- BrandSelector removed -->
                     </div>
                </div>
                <div class="prose dark:prose-invert text-lg space-y-6 text-muted-foreground">
                    <p>
                        how weekly sentiment trends compare with stock price and market volatility.
                    </p>
                </div>
            <a href="#stock-features" class="inline-block pt-4">
                <Button variant="outline" class="gap-2">
                    Next: Feature Analysis <ArrowDown class="h-4 w-4" />
                </Button>
            </a>
        </div>

        <!-- Horizontal Scroll Area -->
        <div class="w-full h-full order-1 lg:order-2 min-w-0">
            <WeeklyFeatureCharts client:visible />
        </div>
    </div>
</section>

<!-- Slide 4: Source vs Target Correlation (New) -->



<!-- Slide 3: Feature Analysis Deep Dive (Carousel) -->
<section id="stock-features" class="h-screen w-full flex items-center justify-center p-8 snap-start bg-muted/30 relative overflow-hidden">
    <div class="container max-w-7xl grid grid-cols-1 lg:grid-cols-3 gap-8 items-center h-full">
         <!-- Sticky Text Side -->
        <div class="space-y-8 lg:col-span-1 h-full flex flex-col justify-center">
            <h3 class="text-3xl font-bold lg:text-4xl">Feature Analysis</h3>
            <div class="prose dark:prose-invert text-lg space-y-4 text-muted-foreground">
                 <p>
                    How much correlation is there between features and stock price? 
                </p>
 
            </div>
        
             <a href="#stock-sourcetarget" class="inline-block pt-8">
                <Button variant="outline" class="gap-2">
                    Next: Community Dynamics <ArrowDown class="h-4 w-4" />
                </Button>
            </a>
        </div>

         <!-- Horizontal Scroll Area (Wider) -->
        <div class="lg:col-span-2 w-full h-full order-1 lg:order-2">
            <FeatureDeepDiveCharts client:visible />
        </div>
    </div>
</section>

<!-- Slide 5: Conclusion / Verdict (New) -->
<section id="stock-conclusion" class="h-screen w-full flex items-center justify-center p-8 snap-start bg-background relative overflow-hidden">
    <div class="container max-w-7xl h-full grid grid-cols-1 lg:grid-cols-[3fr_9fr] gap-12 items-center">
        
        <div class="space-y-8 flex flex-col justify-center h-full order-2 lg:order-1">
            <div class="space-y-4">
                <h3 class="text-4xl font-bold tracking-tight lg:text-5xl">Statistical Hypothesis Testing</h3>
                <p class="text-xl text-muted-foreground">Evaluating the Predictive Power of Reddit Sentiment</p>
            </div>

            <a href="#backstage-intro" class="pt-4 inline-block">
                <Button size="lg" class="gap-2">
                    Final Chapter: Backstage <ArrowRight class="h-4 w-4" />
                </Button>
            </a>
        </div>

        <div class="w-full h-full min-w-0 order-1 lg:order-2 flex items-center">
            <HypothesisCharts client:visible />
        </div>

    </div>
</section>

<style>
    /* Hide scrollbar for Chrome, Safari and Opera */
    .no-scrollbar::-webkit-scrollbar {
        display: none;
    }
    /* Hide scrollbar for IE, Edge and Firefox */
    .no-scrollbar {
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
    }
</style>

<!-- Fixed Brand Selector -->
<FloatingBrandSelector 
    client:load 
    sectionIds={['stock-intro', 'stock-sources', 'stock-weekly', 'stock-features', 'stock-sourcetarget', 'stock-conclusion']} 
/>
